!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.MediumEditorInsert=e():t.MediumEditorInsert=e()}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(2),s=n(o),a=MediumEditor.Extension.extend({name:"insert",addons:{images:!0,embeds:!0},init:function(){MediumEditor.Extension.prototype.init.apply(this,arguments),this.core=new s["default"](this)},destroy:function(){this.core.removeButtons()}});e["default"]=a,t.exports=e["default"]},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]={ucfirst:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},generateRandomString:function(){var t=arguments.length<=0||void 0===arguments[0]?15:arguments[0];return Math.random().toString(36).substr(2,t+2)}},t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(1),u=n(a),r=i(4),d=n(r),l=i(3),c=n(l),p=function(){function t(e){o(this,t),this._plugin=e,this._editor=this._plugin.base,this.initAddons(),this.addButtons(),this.events()}return s(t,[{key:"events",value:function(){var t=this,e=void 0;this._plugin.on(document,"click",this.toggleButtons.bind(this)),this._plugin.on(document,"keyup",this.toggleButtons.bind(this)),this._plugin.on(this.buttons.getElementsByClassName("medium-editor-insert-buttons-show")[0],"click",this.toggleAddons.bind(this)),e=this.buttons.getElementsByClassName("medium-editor-insert-action"),Array.prototype.forEach.call(e,function(e){t._plugin.on(e,"click",t.handleAddonClick.bind(t))}),this._plugin.on(window,"resize",this.positionButtons.bind(this))}},{key:"initAddons",value:function(){var t=this;this._plugin.initializedAddons={images:new d["default"](this._plugin,this._plugin.addons.images),embeds:new c["default"](this._plugin,this._plugin.addons.embeds)},Object.keys(this._plugin.addons).forEach(function(e){var i=t._plugin.addons[e];if(!t._plugin.initializedAddons[e]&&i){var n="MediumEditorInsert"+u["default"].ucfirst(e);window[n]?t._plugin.initializedAddons[e]=new window[n](t._plugin,i):window.console.error('Addon "'+e+"\" couldn't be found!")}i||delete t._plugin.initializedAddons[e]})}},{key:"addButtons",value:function(){var t=this,e=void 0;this.buttons=document.createElement("div"),this.buttons.id="medium-editor-insert-"+this._plugin.getEditorId(),this.buttons.classList.add("medium-editor-insert-buttons"),this.buttons.setAttribute("contentediable",!1),e='<a class="medium-editor-insert-buttons-show">+</a>\n            <ul class="medium-editor-insert-buttons-addons">',Object.keys(this._plugin.initializedAddons).forEach(function(i){var n=t._plugin.initializedAddons[i];e+='<li><a class="medium-editor-insert-action" data-addon="'+i+'">'+n.label+"</a></li>"}),e+="</ul>",this.buttons.innerHTML=e,document.body.appendChild(this.buttons)}},{key:"removeButtons",value:function(){this.buttons.remove()}},{key:"positionButtons",value:function(){var t=void 0,e=void 0,i=void 0,n=void 0,o=void 0,s=void 0,a=void 0;this.buttons.classList.contains("medium-editor-insert-buttons-active")!==!1&&(t=this._editor.getSelectedParentElement(),e=t.getBoundingClientRect(),i=this.buttons.getElementsByClassName("medium-editor-insert-buttons-addons")[0],n=this.buttons.getElementsByClassName("medium-editor-insert-action")[0],o=window.getComputedStyle(i),s=window.getComputedStyle(n),a={top:window.scrollY+e.top,left:window.scrollX+e.left-parseInt(o.left,10)-parseInt(s.marginLeft,10)},a.left=a.left<0?e.left:a.left,this.buttons.style.left=a.left+"px",this.buttons.style.top=a.top+"px")}},{key:"toggleButtons",value:function(){var t=this._editor.getSelectedParentElement();""===t.innerText.trim()?(this.activeParagraph=t,this.showButtons()):(this.activeParagraph=null,this.hideButtons())}},{key:"showButtons",value:function(){this.buttons.classList.add("medium-editor-insert-buttons-active"),this.positionButtons()}},{key:"hideButtons",value:function(){this.buttons.classList.remove("medium-editor-insert-buttons-active"),this.buttons.classList.remove("medium-editor-insert-addons-active")}},{key:"toggleAddons",value:function(){this.buttons.classList.toggle("medium-editor-insert-addons-active")}},{key:"handleAddonClick",value:function(t){var e=t.currentTarget.getAttribute("data-addon");t.preventDefault(),this._plugin.initializedAddons[e].handleClick(t)}}]),t}();e["default"]=p,t.exports=e["default"]},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=function(){function t(e,n){i(this,t),this._plugin=e,this._editor=this._plugin.base,this.options={label:'<span class="fa fa-youtube-play"></span>'},Object.assign(this.options,n),this.label=this.options.label}return n(t,[{key:"handleClick",value:function(){window.console.log("embeds clicked")}}]),t}();e["default"]=o,t.exports=e["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(1),u=n(a),r=function(){function t(e,i){o(this,t),this._plugin=e,this._editor=this._plugin.base,this.options={label:'<span class="fa fa-camera"></span>',preview:!0,uploadUrl:"upload.php"},Object.assign(this.options,i),this.label=this.options.label}return s(t,[{key:"handleClick",value:function(){this._input=document.createElement("input"),this._input.type="file",this._input.multiple=!0,this._plugin.on(this._input,"change",this.uploadFiles.bind(this)),this._input.click()}},{key:"uploadFiles",value:function(){var t=this,e=this._plugin.core.activeParagraph;if("p"===e.nodeName.toLowerCase()){var i=document.createElement("div");e.parentNode.insertBefore(i,e),this._plugin.core.activeParagraph=i,e.remove()}Array.prototype.forEach.call(this._input.files,function(e){var i=u["default"].generateRandomString();t.options.preview&&t.preview(e,i),t.upload(e,i)}),this._plugin.core.hideButtons()}},{key:"preview",value:function(t,e){var i=this,n=new FileReader;n.onload=function(t){i.insertImage(t.target.result,e)},n.readAsDataURL(t)}},{key:"upload",value:function(t,e){var i=this,n=new XMLHttpRequest,o=new FormData;n.open("POST",this.options.uploadUrl,!0),n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){var t=i._plugin.core.activeParagraph.querySelector('[data-uid="'+e+'"]');t?i.replaceImage(t,n.responseText):i.insertImage(n.responseText)}},o.append("file",t),n.send(o)}},{key:"insertImage",value:function(t,e){var i=this._plugin.core.activeParagraph,n=document.createElement("figure"),o=document.createElement("img");o.src=t,o.alt="",e&&o.setAttribute("data-uid",e),n.appendChild(o),i.classList.add("medium-editor-insert-images"),i.appendChild(n)}},{key:"replaceImage",value:function(t,e){t.src=e,t.removeAttribute("data-uid")}}]),t}();e["default"]=r,t.exports=e["default"]}])});
//# sourceMappingURL=medium-editor-insert.min.js.map